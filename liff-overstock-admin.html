<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>æº¢å¤šå•†å“ç®¡ç†</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
<h2>ğŸ“¦ æº¢å¤šå•†å“ç®¡ç†</h2>

<h3>â• æ–°å¢ç¾è²¨</h3>
<input id="name" placeholder="å•†å“å">
<input id="color" placeholder="é¡è‰²">
<input id="size" placeholder="å°ºå¯¸">
<input id="price" placeholder="åƒ¹æ ¼">
<input id="qty" placeholder="æ•¸é‡">
<button onclick="add()">æ–°å¢</button>

<hr>
<h3>ğŸ“‹ æ¸…å–®</h3>
<div id="list"></div>

<script>
liff.init({ liffId: "2008857998-qCQWSTKf" }).then(load);

async function load() {
  const res = await fetch("/api/overstock/admin");
  const items = await res.json();
  document.getElementById("list").innerHTML =
    items.map(i => `
      <div>
        ${i.product_name} (${i.qty}) - ${i.status}
        <button onclick="closeItem('${i.overstock_id}')">é—œé–‰</button>
      </div>
    `).join("");
}

async function add() {
  await fetch("/api/overstock/admin/create", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      name: name.value,
      color: color.value,
      size: size.value,
      price: price.value,
      qty: qty.value
    })
  });
  load();
}

async function closeItem(id) {
  await fetch("/api/overstock/admin/close", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ overstockId: id })
  });
  load();
}
</script>
</body>
</html>
